<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Auto Rationale Engine</title>
<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:20px;
}
.container {
  max-width:1000px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:8px;
  box-shadow:0 0 10px rgba(0,0,0,0.1);
}
.option {
  margin:10px 0;
  padding:10px;
  border:1px solid #ccc;
  border-radius:6px;
}
button {
  margin-top:15px;
  padding:10px 20px;
  font-size:16px;
}
.hidden { display:none; }

.review {
  margin-top:20px;
  padding:15px;
  background:#f9fafb;
  border-left:5px solid #007bff;
}

.tag {
  font-size:12px;
  padding:2px 6px;
  border-radius:4px;
  margin-left:6px;
}
.SCFHS { background:#d4edda; }
.NCLEX { background:#cce5ff; }
.STR { background:#fff3cd; }
.SAFE_DELAY { background:#e2e3e5; }

.expand {
  margin-top:15px;
  background:#eef5ff;
  padding:12px;
  border-radius:6px;
}
.expand pre {
  background:#fff;
  padding:10px;
  border:1px dashed #007bff;
  white-space:pre-wrap;
}
.header {
  font-weight:bold;
  margin-top:10px;
}
</style>
</head>
<body>

<div class="container">

<h2>SCFHS Pathophysiologic Rationale Engine</h2>

<div id="quiz"></div>

<button onclick="submitAnswer()">Submit</button>
<button onclick="nextQuestion()" id="nextBtn" class="hidden">Next</button>

<div id="review" class="review hidden"></div>

</div>

<script>
// ================================
// QUESTION BANK — INJECT YOUR QUESTIONS HERE
// ================================
const questions = [
  {
    q: "When a nurse places a febrile infant into cold water, how is heat primarily lost?",
    options: [
      { text: "Evaporation", tag: "SAFE_DELAY" },
      { text: "Convection", tag: "NCLEX" },
      { text: "Conduction", tag: "SCFHS" },
      { text: "Radiation", tag: "STR" }
    ],
    correctTag: "SCFHS",
    mechanism: "heatTransfer.conduction"
  }

  // <-- add more questions here in the same format
];

// ================================
// CENTRAL RATIONALE LIBRARY
// ================================
const rationaleLibrary = {
  heatTransfer: {
    conduction: {
      correct:
        "Direct contact transfers heat from warm skin to cold water, defining conduction as the main mechanism.",
      distractors: {
        SAFE_DELAY:
          "Evaporation requires liquid turning to vapor, which does not occur during immersion.",
        NCLEX:
          "Convection involves moving air or fluid, not direct contact.",
        STR:
          "Radiation transfers heat without physical contact."
      },
      exam:
`Conduction → direct contact
Convection → moving air or fluid
Radiation → no contact
Evaporation → liquid to vapor`,
      patho:
`Immersion → thermal gradient established → heat flows from warm skin to cold water → core temperature decreases`,
      intuitive:
`Touching ice = conduction
Cold wind = convection
Sun exposure = radiation
Sweat drying = evaporation`
    }
  }
};

// ================================
// ENGINE STATE
// ================================
let index = 0;

// ================================
// RENDER QUESTION
// ================================
function renderQuestion() {
  const q = questions[index];
  document.getElementById("review").classList.add("hidden");
  document.getElementById("nextBtn").classList.add("hidden");

  document.getElementById("quiz").innerHTML = `
    <p><b>Question ${index + 1}:</b><br>${q.q}</p>
    ${q.options.map((o,i)=>`
      <div class="option">
        <input type="radio" name="ans" value="${o.tag}">
        ${String.fromCharCode(65+i)}. ${o.text}
        <span class="tag ${o.tag}">${o.tag}</span>
      </div>
    `).join("")}
  `;
}

// ================================
// SUBMIT ANSWER
// ================================
function submitAnswer() {
  const selected = document.querySelector('input[name="ans"]:checked');
  if (!selected) return alert("Select an answer.");

  const q = questions[index];
  const review = document.getElementById("review");
  review.classList.remove("hidden");

  const [group, key] = q.mechanism.split(".");
  const mech = rationaleLibrary[group][key];

  let html = `
  <div class="header">✅ Correct Rationale</div>
  ${mech.correct}

  <div class="header">❌ Option-by-Option Analysis</div>
  `;

  q.options.forEach(o => {
    if (o.tag === q.correctTag) {
      html += `<div><b>${o.text}</b> (${o.tag}) — Correct</div>`;
    } else {
      html += `<div><b>${o.text}</b> (${o.tag}) — ${mech.distractors[o.tag]}</div>`;
    }
  });

  html += `
  <div class="expand">
    <div class="header">Core Principle (Exam Language)</div>
    <pre>${mech.exam}</pre>

    <div class="header">Pathophysiologic Chain</div>
    <pre>${mech.patho}</pre>

    <div class="header">Intuitive Clinical Mapping</div>
    <pre>${mech.intuitive}</pre>
  </div>
  `;

  review.innerHTML = html;
  document.getElementById("nextBtn").classList.remove("hidden");
}

// ================================
// NEXT QUESTION
// ================================
function nextQuestion() {
  index++;
  if (index >= questions.length) {
    document.getElementById("quiz").innerHTML = "<h3>End of Review</h3>";
    document.getElementById("review").classList.add("hidden");
    document.getElementById("nextBtn").classList.add("hidden");
    return;
  }
  renderQuestion();
}

// INIT
renderQuestion();
</script>

</body>
</html>
