<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Prometric – Rationale Engine Demo</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 20px;
}
.container {
  max-width: 900px;
  margin: auto;
  background: #fff;
  padding: 25px;
  border-radius: 8px;
}
h2 {
  margin-top: 0;
}
.option {
  border: 1px solid #ccc;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 5px;
  cursor: pointer;
}
.option input {
  margin-right: 10px;
}
.option.correct {
  border-color: #2ecc71;
  background: #eafaf1;
}
.option.wrong {
  border-color: #e74c3c;
  background: #fdecea;
}
.option.locked {
  pointer-events: none;
  opacity: 0.85;
}
.label {
  font-size: 12px;
  font-weight: bold;
  margin-top: 5px;
}
.scfhs { color: #27ae60; }
.nclex { color: #f39c12; }
.str { color: #e67e22; }
.trap { color: #c0392b; }

button {
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 16px;
}
#submitBtn { background: #3498db; color: #fff; }
#nextBtn { background: #2ecc71; color: #fff; display: none; }

#rationaleBox {
  margin-top: 25px;
  padding: 20px;
  border-top: 2px solid #ddd;
  display: none;
}
.patho {
  margin-top: 15px;
  padding: 15px;
  background: #f9f9f9;
  border-left: 5px solid #555;
  font-family: monospace;
}
</style>
</head>

<body>

<div class="container">

<h2>SCFHS Prometric Demo Question</h2>

<p><b>Q1.</b> A 68-year-old male presents with BP 86/52, HR 122, RR 28, SpO₂ 90%. He appears restless and pale. What is the nurse’s PRIORITY action?</p>

<div id="options">
  <label class="option">
    <input type="radio" name="answer" value="0">
    Administer IV isotonic fluids
  </label>

  <label class="option">
    <input type="radio" name="answer" value="1">
    Administer antihypertensive medication
  </label>

  <label class="option">
    <input type="radio" name="answer" value="2">
    Provide reassurance and recheck vital signs
  </label>

  <label class="option">
    <input type="radio" name="answer" value="3">
    Obtain informed consent for treatment
  </label>
</div>

<br>
<button id="submitBtn">Submit Answer</button>
<button id="nextBtn">Next Question</button>

<div id="rationaleBox"></div>

</div>

<script>
const question = {
  correctIndex: 0,
  options: [
    {
      label: "SCFHS_CORRECT",
      rationale: "Hypotension with tachycardia indicates circulatory shock. IV isotonic fluids increase preload, cardiac output, and tissue perfusion immediately."
    },
    {
      label: "NCLEX_TRAP",
      rationale: "NCLEX may emphasize BP control, but in SCFHS hypotension reflects shock. Antihypertensives worsen perfusion and accelerate collapse."
    },
    {
      label: "DISTRACTOR",
      rationale: "Reassurance does not address the underlying hemodynamic instability or prevent organ hypoperfusion."
    },
    {
      label: "STR_DELAY",
      rationale: "Consent is appropriate later. In life-threatening instability, treatment proceeds under implied consent."
    }
  ],
  pathophysiology: `
[ ↓ Intravascular Volume / Shock ]
              ↓
        [ ↓ Preload ]
              ↓
     [ ↓ Cardiac Output ]
              ↓
[ Hypotension + Tachycardia ]
              ↓
     [ ORGAN HYPOPERFUSION ]
`
};

document.getElementById("submitBtn").onclick = function () {
  const selected = document.querySelector('input[name="answer"]:checked');
  if (!selected) {
    alert("Please select an answer.");
    return;
  }

  const selectedIndex = parseInt(selected.value);
  const optionDivs = document.querySelectorAll(".option");

  optionDivs.forEach((div, i) => {
    div.classList.add("locked");

    if (i === question.correctIndex) {
      div.classList.add("correct");
    } else if (i === selectedIndex) {
      div.classList.add("wrong");
    }

    const info = document.createElement("div");
    info.className = "label " + labelClass(question.options[i].label);
    info.innerText = question.options[i].label.replace("_", " ");
    div.appendChild(info);
  });

  showRationale();
  document.getElementById("submitBtn").style.display = "none";
  document.getElementById("nextBtn").style.display = "inline-block";
};

function labelClass(label) {
  if (label.includes("SCFHS")) return "scfhs";
  if (label.includes("NCLEX")) return "nclex";
  if (label.includes("STR")) return "str";
  return "trap";
}

function showRationale() {
  const box = document.getElementById("rationaleBox");
  box.style.display = "block";

  let html = "<h3>Rationale (Option-by-Option)</h3>";

  question.options.forEach((opt, i) => {
    html += `<p><b>Option ${i + 1}:</b> ${opt.rationale}</p>`;
  });

  html += `<h3>Pathophysiology Sketch</h3>
           <div class="patho">${question.pathophysiology}</div>`;

  box.innerHTML = html;
}
</script>

</body>
</html>
