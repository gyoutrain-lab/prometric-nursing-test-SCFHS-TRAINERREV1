<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS Generic Rationale Machine</title>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:20px;
}
.container {
  max-width:900px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:8px;
  box-shadow:0 0 10px rgba(0,0,0,0.1);
}
.option {
  margin:10px 0;
  padding:10px;
  border:1px solid #ccc;
  border-radius:6px;
}
button {
  margin-top:15px;
  padding:10px 20px;
  font-size:16px;
}
.hidden { display:none; }

.review {
  margin-top:20px;
  padding:15px;
  background:#f9fafb;
  border-left:5px solid #007bff;
}

.tag {
  font-size:12px;
  padding:2px 6px;
  border-radius:4px;
  margin-left:6px;
}
.SCFHS { background:#d4edda; }
.NCLEX { background:#cce5ff; }
.STR { background:#fff3cd; }
.SAFE_DELAY { background:#e2e3e5; }

.expand {
  margin-top:10px;
  background:#eef5ff;
  padding:10px;
  border-radius:6px;
}
.expand pre {
  background:#fff;
  padding:10px;
  border:1px dashed #007bff;
}
</style>
</head>

<body>
<div class="container">

<h2>SCFHS Pathophysiologic Rationale Machine</h2>

<div id="quiz"></div>

<button onclick="submitAnswer()">Submit</button>
<button onclick="nextQuestion()" id="nextBtn" class="hidden">Next</button>

<div id="review" class="review hidden"></div>

</div>

<script>
// ===================================
// QUESTION BANK (INJECT ANY QUESTIONS)
// ===================================
const questions = [
  {
    q: "When a nurse places a febrile infant into cold water as an emergency intervention, through which mechanism will the infant primarily lose body heat?",
    options: [
      { text: "Evaporation", tag: "SAFE_DELAY" },
      { text: "Convection", tag: "NCLEX" },
      { text: "Conduction", tag: "SCFHS" },
      { text: "Radiation", tag: "STR" }
    ],
    correctTag: "SCFHS",
    rationale: {
      correct: "Direct contact between the infant’s body and cold water allows thermal energy to transfer from the warmer skin to the cooler medium, which defines conduction.",
      distractors: {
        SAFE_DELAY: "Evaporation requires liquid to change into vapor, which does not occur during immersion.",
        NCLEX: "Convection involves heat transfer through movement of air or fluid, not direct contact.",
        STR: "Radiation is heat transfer without physical contact."
      },
      mechanism: "heatTransfer"
    }
  }
];

// ===================================
// MECHANISM EXPLANATION ENGINE
// ===================================
const mechanismLibrary = {
  heatTransfer: {
    exam: `
Conduction → direct physical contact
Convection → heat loss via moving air or fluid
Radiation → heat transfer without contact
Evaporation → liquid to vapor
    `,
    patho: `
During immersion, heat moves directly from the warmer skin to the colder water
surface. This direct energy transfer makes conduction the dominant mechanism,
while convection, radiation, and evaporation play minimal roles.
    `,
    intuitive: `
Touching ice = conduction
Cold wind = convection
Sun heat = radiation
Sweat drying = evaporation
    `
  }
};

// ===================================
// ENGINE STATE
// ===================================
let index = 0;

// ===================================
// RENDER QUESTION
// ===================================
function renderQuestion() {
  const q = questions[index];
  document.getElementById("review").classList.add("hidden");
  document.getElementById("nextBtn").classList.add("hidden");

  document.getElementById("quiz").innerHTML = `
    <p><b>Question ${index + 1}:</b><br>${q.q}</p>
    ${q.options.map((o,i)=>`
      <div class="option">
        <input type="radio" name="ans" value="${o.tag}">
        ${String.fromCharCode(65+i)}. ${o.text}
        <span class="tag ${o.tag}">${o.tag}</span>
      </div>
    `).join("")}
  `;
}

// ===================================
// SUBMIT ANSWER
// ===================================
function submitAnswer() {
  const selected = document.querySelector('input[name="ans"]:checked');
  if (!selected) return alert("Select an answer.");

  const q = questions[index];
  const review = document.getElementById("review");
  review.classList.remove("hidden");

  let html = `
  <b>Correct Rationale:</b><br>
  ${q.rationale.correct}<br><br>
  <b>Option Analysis:</b><br>
  `;

  q.options.forEach(o=>{
    if (o.tag === q.correctTag) {
      html += `<div><b>${o.text}</b> (${o.tag}) — ✅ Correct</div>`;
    } else {
      html += `<div><b>${o.text}</b> (${o.tag}) — ❌ ${q.rationale.distractors[o.tag]}</div>`;
    }
  });

  const mech = mechanismLibrary[q.rationale.mechanism];
  if (mech) {
    html += `
    <div class="expand">
      <b>Core Principle (Exam):</b>
      <pre>${mech.exam}</pre>
      <b>Pathophysiologic Elaboration:</b>
      <pre>${mech.patho}</pre>
      <b>Intuitive Explanation:</b>
      <pre>${mech.intuitive}</pre>
    </div>
    `;
  }

  review.innerHTML = html;
  document.getElementById("nextBtn").classList.remove("hidden");
}

// ===================================
// NEXT QUESTION
// ===================================
function nextQuestion() {
  index++;
  if (index >= questions.length) {
    document.getElementById("quiz").innerHTML = "<h3>End of Review</h3>";
    document.getElementById("review").classList.add("hidden");
    document.getElementById("nextBtn").classList.add("hidden");
    return;
  }
  renderQuestion();
}

// INIT
renderQuestion();
</script>

</body>
</html>
